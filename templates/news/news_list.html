{% extends "base.html" %}
{% block title %}Новости — Юнона{% endblock %}
{% block meta_description %}Актуальные новости МБОУ ИТ Гимназия Юнона. События, достижения, мероприятия и важная информация о жизни школы.{% endblock %}
{% block meta_keywords %}новости школы, события гимназии Юнона, школьные мероприятия, достижения учащихся{% endblock %}
{% block content %}
<h1>Новости</h1>
<style>
  .news-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; margin-top: 16px; }
  .news-tile { display: block; text-decoration: none; color: inherit; background: #fff; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.1); transition: transform 0.2s, box-shadow 0.2s; }
  .news-tile:hover { transform: translateY(-4px); box-shadow: 0 8px 20px rgba(0,0,0,0.15); color: inherit; }
  .news-tile-img { aspect-ratio: 16/10; background: #e2e8f0; overflow: hidden; }
  .news-tile-img img { width: 100%; height: 100%; object-fit: cover; display: block; }
  .news-tile-body { padding: 12px 14px; }
  .news-tile-title { font-weight: 600; font-size: 1rem; color: #1e293b; line-height: 1.35; }
  .news-tile-date { font-size: 0.85rem; color: #64748b; margin-top: 4px; }
  .news-add-tile { display: flex; align-items: center; justify-content: center; text-decoration: none; background: linear-gradient(135deg, #10b981, #059669); color: white; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); font-weight: 600; font-size: 1.1rem; transition: transform 0.2s, box-shadow 0.2s; min-height: 180px; }
  .news-add-tile:hover { transform: translateY(-4px); box-shadow: 0 8px 20px rgba(16,185,129,0.4); color: white; }
  @media (max-width: 1100px) { .news-grid { grid-template-columns: repeat(3, 1fr); } }
  @media (max-width: 768px) { .news-grid { grid-template-columns: repeat(2, 1fr); gap: 12px; } }
  @media (max-width: 480px) { .news-grid { grid-template-columns: 1fr; } }
</style>
<div class="news-grid">
  {% if current_user.is_authenticated %}
  <a href="/news/new" class="news-add-tile">Добавить новость</a>
  {% endif %}
  {% for n in news %}
  <a href="/news/{{ n.id }}" class="news-tile">
    <div class="news-tile-img">
      {% set image_files = n.files | selectattr('kind', 'equalto', 'image') | list %}
      {% if image_files %}
        <img src="{{ (image_files[0]).filename | news_file_url(n.id) }}" alt="{{ n.title }}">
      {% else %}
        <div style="width:100%;height:100%;display:flex;align-items:center;justify-content:center;color:#94a3b8;">Нет фото</div>
      {% endif %}
    </div>
    <div class="news-tile-body">
      <div class="news-tile-title">{{ n.title | truncate(50, True, '...') }} {% if n.is_featured %}⭐{% endif %}</div>
      <div class="news-tile-date">{{ (n.publication_date or n.created_at).strftime('%d.%m.%Y') }}</div>
    </div>
  </a>
  {% endfor %}
</div>
{% if not news and not current_user.is_authenticated %}
<div style="margin-top: 16px; color: var(--color-muted);">Нет новостей</div>
{% endif %}
{% endblock %}
